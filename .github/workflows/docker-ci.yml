name: CI/CD Pipeline

on:
  push:
    branches:
      - master  # ğŸ”¥ DÃ©clenche l'action quand tu pushes sur la branche `master`

jobs:
  build-and-push:
    name: Build & Push Docker Image
    runs-on: ubuntu-latest  # ğŸ”¥ GitHub va utiliser un serveur Linux

    steps:
      - name: ğŸš€ TÃ©lÃ©charger le code depuis GitHub
        uses: actions/checkout@v4  # GitHub tÃ©lÃ©charge le code

      - name: ğŸ”‘ Se connecter Ã  Docker Hub
        run: echo "${{ secrets.DOCKER_PASSWORD }}" | docker login -u "${{ secrets.DOCKER_USERNAME }}" --password-stdin

      # ğŸ”¥ Construire l'image Docker de l'API
      - name: ğŸ› ï¸ Construire l'image Docker de l'API
        run: docker build -t seynaboubk/mon-api:latest -f Dockerfile .

      # ğŸ”¥ Pousser l'image Docker de l'API sur Docker Hub
      - name: ğŸš€ Envoyer l'image API sur Docker Hub
        run: docker push seynaboubk/mon-api:latest

      # ğŸ”¥ Construire l'image Docker de Nginx
      - name: ğŸ› ï¸ Construire l'image Docker de Nginx
        run: docker build -t seynaboubk/mon-nginx:latest -f Dockerfile.nginx .

      # ğŸ”¥ Pousser l'image Docker de Nginx sur Docker Hub
      - name: ğŸš€ Envoyer l'image Nginx sur Docker Hub
        run: docker push seynaboubk/mon-nginx:latest




























# name: CI/CD Pipeline

# on:
#   push:
#     branches:
#       - master  # DÃ©clenche l'action quand tu pushes sur la branche `main`

# jobs:
#   build-and-push:
#     name: Build & Push Docker Image
#     runs-on: ubuntu-latest  # GitHub va utiliser un serveur Linux

#     steps:
#       - name: TÃ©lÃ©charger le code depuis GitHub
#         uses: actions/checkout@v4  # GitHub tÃ©lÃ©charge le code

#       - name: Se connecter Ã  Docker Hub
#         uses: docker/login-action@v3
#         with:
#           username: ${{ secrets.DOCKER_USERNAME }}
#           password: ${{ secrets.DOCKER_PASSWORD }}

#       - name: Construire l'image Docker de l'API
#         run: docker build -t seynaboubk/mon-api:latest -f Dockerfile .

#       - name: Envoyer l'image API sur Docker Hub
#         run: docker push seynaboubk/mon-api:latest

#       - name: Construire l'image Docker de Nginx
#         run: docker build -t seynaboubk/mon-nginx:latest -f Dockerfile.nginx .

#       - name: Envoyer l'image Nginx sur Docker Hub
#         run: docker push seynaboubk/mon-nginx:latest
